<!DOCTYPE html>
<html lang="en" data-theme="{{ current_theme }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Zone Plate Generator{% endblock %}</title>
    
    <!-- CSS Variables for theming -->
    <style>
        :root[data-theme="{{ current_theme }}"] {
            --primary-color: {{ theme_config.primary }};
            --secondary-color: {{ theme_config.secondary }};
            --success-color: {{ theme_config.success }};
            --danger-color: {{ theme_config.danger }};
            --warning-color: {{ theme_config.warning }};
            --info-color: {{ theme_config.info }};
            --background-color: {{ theme_config.background }};
            --surface-color: {{ theme_config.surface }};
            --text-color: {{ theme_config.text }};
        }
    </style>
    
    <!-- Custom CSS (no external dependencies) -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    
    {% block extra_head %}{% endblock %}
</head>
<body data-theme="{{ current_theme }}">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('main.index') }}">
                <span class="icon-dot"></span>
                Zone Plate Generator
            </a>
            <input type="checkbox" id="nav-toggle" class="nav-toggle" aria-label="Toggle navigation">
            <label for="nav-toggle" class="nav-toggle-label">
                <span class="hamburger"></span>
            </label>
            
            <div class="nav-menu">
                <div class="theme-switcher">
                    <input type="checkbox" id="theme-toggle" class="theme-toggle-checkbox" aria-label="Show theme palette">
                    <label for="theme-toggle" class="theme-toggle-label" title="Change theme">
                        <span class="theme-palette-icon" aria-hidden="true">
                            <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="1" fill="none" aria-hidden="true" focusable="false">
                                <circle cx="12" cy="12" r="9" />
                                <circle cx="8" cy="8" r="2" fill="var(--primary-color)" />
                                <circle cx="16" cy="8" r="2" fill="var(--success-color)" />
                                <circle cx="8" cy="16" r="2" fill="var(--warning-color)" />
                                <circle cx="16" cy="16" r="2" fill="var(--info-color)" />
                            </svg>
                        </span>
                    </label>
                    <div class="theme-palette">
                        <form method="post" action="{{ url_for('main.set_theme') }}" class="theme-palette-form">
                            {% for theme_key, theme_data in themes.items() %}
                            <button type="submit"
                                name="theme"
                                value="{{ theme_key }}"
                                class="theme-palette-btn"
                                style="--palette-primary: {{ theme_data.primary }}; --palette-bg: {{ theme_data.background }}; --palette-text: {{ theme_data.text }};"
                                aria-label="Switch to {{ theme_data.name }}">
                                <span class="theme-palette-preview"
                                    style="background: var(--palette-bg); color: var(--palette-text); border-color: var(--palette-primary);">
                                    &#9679;
                                </span>
                                <span class="theme-palette-name">{{ theme_data.name }}</span>
                            </button>
                            {% endfor %}
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container">
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'error' else category }}">
                        {{ message }}
                        <input type="checkbox" class="alert-close-checkbox" id="alert-close-{{ loop.index }}">
                        <label for="alert-close-{{ loop.index }}" class="alert-close">&times;</label>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h6>Zone Plate Generator</h6>
                    <p class="footer-text">
                        Generate Fresnel zone plates, zone sieves, and photon sieves using PostScript and Ghostscript.
                    </p>
                </div>
                <div class="footer-section footer-right">
                    <p class="footer-text">
                        Built with Python, Flask, and CSS<br>
                        <a href="#" class="footer-link">View on GitHub</a>
                    </p>
                </div>
            </div>
        </div>
    </footer>
    {% block extra_scripts %}{% endblock %}
</body>
</html>
