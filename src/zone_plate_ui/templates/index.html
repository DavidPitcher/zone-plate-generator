{% extends "base.html" %}

{% block title %}Zone Plate Generator - Create Fresnel Zone Plates{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Zone Plate Generator</h1>
    <p class="page-subtitle">
        Generate high-quality Fresnel zone plates, zone sieves, and photon sieves for optical applications
    </p>
</div>

<div class="layout-grid">
    <!-- Main Form -->
    <div class="form-container">
    <form method="post" action="{{ url_for('main.generate') }}" class="zone-form">
            <!-- Zone Plate Type Selection -->
            <fieldset class="form-section">
                <legend>Zone Plate Type</legend>
                <div class="radio-grid">
                    {% for type_key, type_name in valid_types.items() %}
                    <div class="radio-card">
                        <input type="radio" id="type_{{ type_key.lower() }}" name="type" value="{{ type_key }}" 
                               {% if type_key == default_params.type %}checked{% endif %} required>
                        <label for="type_{{ type_key.lower() }}" class="radio-label">
                            <span class="radio-visual"></span>
                            <div class="radio-content">
                                <strong class="radio-title">{{ type_name }}</strong>
                                <small class="radio-description">
                                    {% if type_key == 'PLATE' %}Classic Fresnel zone plate{% endif %}
                                    {% if type_key == 'SIEVE' %}Perforated zone plate{% endif %}
                                    {% if type_key == 'PHOTON' %}Photon sieve design{% endif %}
                                    {% if type_key == 'GRID' %}All types in grid layout{% endif %}
                                </small>
                            </div>
                        </label>
                    </div>
                    {% endfor %}
                </div>
            </fieldset>

            <!-- Basic Parameters -->
            <fieldset class="form-section">
                <legend>Basic Parameters</legend>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="focal_length" class="form-label">
                            Focal Length (mm)
                            <span class="help-icon" data-tooltip="{{ tooltips['focal_length'] }}" tabindex="0">?</span>
                        </label>
                        <input type="number" id="focal_length" name="focal_length" 
                               value="{{ default_params.focal_length }}" 
                               min="1" max="10000" step="0.1" 
                               class="form-control" required>
                        <small class="form-help">Distance at which the zone plate focuses light</small>
                    </div>

                    <div class="form-group">
                        <label for="rings" class="form-label">
                            Number of Rings
                            <span class="help-icon" data-tooltip="{{ tooltips['rings'] }}" tabindex="0">?</span>
                        </label>
                        <input type="number" id="rings" name="rings" 
                               value="{{ default_params.rings }}" 
                               min="1" max="50" 
                               class="form-control" required>
                        <small class="form-help">Total number of alternating zones</small>
                    </div>

                    <div class="form-group">
                        <label for="wavelength" class="form-label">
                            Wavelength (mm)
                            <span class="help-icon" data-tooltip="{{ tooltips['wavelength'] }}" tabindex="0">?</span>
                        </label>
                        <input type="number" id="wavelength" name="wavelength" 
                               value="{{ default_params.wavelength }}" 
                               min="0.0001" max="0.001" step="0.00001" 
                               class="form-control" required>
                        <small class="form-help">Green: 0.00022, Daylight: 0.00056</small>
                    </div>

                    <div class="form-group">
                        <label for="output_format" class="form-label">
                            Output Format
                            <span class="help-icon" data-tooltip="{{ tooltips['output_format'] }}" tabindex="0">?</span>
                        </label>
                        <select id="output_format" name="output_format" class="form-control" required>
                            {% for format_option in valid_formats %}
                            <option value="{{ format_option }}" 
                                    {% if format_option == default_params.output_format %}selected{% endif %}>
                                {{ format_option }}
                            </option>
                            {% endfor %}
                        </select>
                        <small class="form-help">PNG: digital, TIFF: print, PDF: vector</small>
                    </div>
                </div>
            </fieldset>

            <!-- Physical Parameters -->
            <fieldset class="form-section">
                <legend>Physical Parameters</legend>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="punch_diameter" class="form-label">
                            Punch Diameter (mm)
                            <span class="help-icon" data-tooltip="{{ tooltips['punch_diameter'] }}" tabindex="0">?</span>
                        </label>
                        <input type="number" id="punch_diameter" name="punch_diameter" 
                               value="{{ default_params.punch_diameter }}" 
                               min="1" max="1000" step="0.1" 
                               class="form-control" required>
                        <small class="form-help">Cutting outline diameter</small>
                    </div>

                    <div class="form-group">
                        <label for="magnification" class="form-label">
                            Magnification
                            <span class="help-icon" data-tooltip="{{ tooltips['magnification'] }}" tabindex="0">?</span>
                        </label>
                        <input type="number" id="magnification" name="magnification" 
                               value="{{ default_params.magnification }}" 
                               min="0.1" max="100" step="0.1" 
                               class="form-control" required>
                        <small class="form-help">Scale factor for printing</small>
                    </div>

                    <div class="form-group">
                        <label for="padding" class="form-label">
                            Padding (mm)
                            <span class="help-icon" data-tooltip="{{ tooltips['padding'] }}" tabindex="0">?</span>
                        </label>
                        <input type="number" id="padding" name="padding" 
                               value="{{ default_params.padding }}" 
                               min="0" max="100" step="0.1" 
                               class="form-control" required>
                        <small class="form-help">Border spacing</small>
                    </div>

                    <div class="form-group">
                        <label for="negative_mode" class="checkbox-label">
                            <input type="checkbox" id="negative_mode" name="negative_mode" 
                                   {% if default_params.negative_mode %}checked{% endif %}>
                            <span class="checkbox-visual"></span>
                            Negative Mode
                            <span class="help-icon" data-tooltip="{{ tooltips['negative_mode'] }}" tabindex="0">?</span>
                        </label>
                        <small class="form-help">Invert colors for film negatives</small>
                    </div>
                </div>
            </fieldset>

            <!-- Advanced Parameters (Collapsible) -->
            <details class="advanced-section">
                <summary class="advanced-toggle">Advanced Parameters</summary>
                <div class="advanced-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="sieve_scale" class="form-label">
                                Sieve Scale Factor
                                <span class="help-icon" data-tooltip="{{ tooltips['sieve_scale'] }}" tabindex="0">?</span>
                            </label>
                            <input type="number" id="sieve_scale" name="sieve_scale" 
                                   value="{{ default_params.sieve_scale }}" 
                                   min="0.1" max="10" step="0.1" 
                                   class="form-control">
                            <small class="form-help">Hole size multiplier</small>
                        </div>

                        <div class="form-group">
                            <label for="sieve_space" class="form-label">
                                Sieve Spacing (mm)
                                <span class="help-icon" data-tooltip="{{ tooltips['sieve_space'] }}" tabindex="0">?</span>
                            </label>
                            <input type="number" id="sieve_space" name="sieve_space" 
                                   value="{{ default_params.sieve_space }}" 
                                   min="0.001" max="1" step="0.001" 
                                   class="form-control">
                            <small class="form-help">Gap between holes</small>
                        </div>

                        <div class="form-group">
                            <label for="dup_focal" class="form-label">
                                Camera Focal Length (mm)
                                <span class="help-icon" data-tooltip="{{ tooltips['dup_focal'] }}" tabindex="0">?</span>
                            </label>
                            <input type="number" id="dup_focal" name="dup_focal" 
                                   value="{{ default_params.dup_focal }}" 
                                   min="1" max="10000" step="1" 
                                   class="form-control">
                            <small class="form-help">For camera positioning calculations</small>
                        </div>
                    </div>
                </div>
            </details>

            <!-- Quick Presets -->
            <fieldset class="form-section">
                <legend>Quick Presets</legend>
                <div class="preset-buttons">
                    <button type="button" class="btn btn-outline preset-btn" data-preset="photography">
                        Photography
                    </button>
                    <button type="button" class="btn btn-outline preset-btn" data-preset="solar">
                        Solar Observation
                    </button>
                    <button type="button" class="btn btn-outline preset-btn" data-preset="microscopy">
                        Microscopy
                    </button>
                </div>
            </fieldset>

            <!-- Form Actions -->
            <div class="form-actions">
                <button type="reset" class="btn btn-secondary">
                    Reset Form
                </button>
                <button type="submit" class="btn btn-primary">
                    Generate Zone Plate
                </button>
            </div>
        </form>
    </div>

    <!-- Information Panel -->
    <div class="info-panel">
        <!-- Status Card -->
        <div class="info-card">
            <h3 class="info-title">Generation Status</h3>
            <div class="status-display">
                <div class="status-icon">⚪</div>
                <p class="status-text">Ready to generate</p>
                <small class="status-help">Configure parameters and submit form</small>
            </div>
        </div>

        <!-- Help Card -->
        <div class="info-card">
            <h3 class="info-title">Quick Help</h3>
            
            <details class="help-section">
                <summary>Zone Plate Types</summary>
                <ul class="help-list">
                    {% for type_key, type_name in valid_types.items() %}
                    <li><strong>{{ type_name }}:</strong> 
                        {% if type_key == 'GRID' %}Shows all types on one page{% endif %}
                        {% if type_key == 'PLATE' %}Traditional Fresnel zone plate{% endif %}
                        {% if type_key == 'SIEVE' %}Zone plate with perforated rings{% endif %}
                        {% if type_key == 'PHOTON' %}Zone sieve that has been inverted{% endif %}
                    </li>
                    {% endfor %}
                </ul>
            </details>

            <details class="help-section">
                <summary>Common Wavelengths</summary>
                <ul class="help-list">
                    <li><strong>0.00022 mm:</strong> Green light</li>
                    <li><strong>0.00056 mm:</strong> Daylight (yellow)</li>
                    <li><strong>0.00045 mm:</strong> Blue light</li>
                    <li><strong>0.00065 mm:</strong> Red light</li>
                </ul>
            </details>

            <details class="help-section">
                <summary>Output Formats</summary>
                <ul class="help-list">
                    <li><strong>PNG:</strong> Best for digital viewing</li>
                    <li><strong>TIFF:</strong> High quality for printing</li>
                    <li><strong>PDF:</strong> Vector format, scalable</li>
                </ul>
            </details>
        </div>
    </div>
</div>
{% endblock %}
